
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Removing malware - Yen's Blog</title>
  <meta name="author" content="Yen Tran">

  
  <meta name="description" content="My computer got a dose of malware today.   The trojan got a hold of my USB drive.  It made all of my files and folders hidden, then injected &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dinhyen.github.io/blog/2011/08/23/removing-malware">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Yen's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Yen's Blog</a></h1>
  
    <h2>Lens, Wheels, Skates, Keyboard</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dinhyen.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/travel">Travel</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Removing Malware</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-08-23T00:00:00-04:00" pubdate data-updated="true">Aug 23<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>My computer got a dose of malware today.   The trojan got a hold of my USB drive.  It made all of my files and folders hidden, then injected executables with the same names.  It also hid the .exe extension so that the executables appeared in place of the legitimate objects they were masquerading.  It gave the fake folders the right icon so that they looked just like folders.  The objective is to fool the user into double-clicking the folders to open them but instead executing the trojan.</p>

<p><img title="malware" src="https://dl.dropboxusercontent.com/u/52804626/images/malware.png" width="477" height="206" /></p>

<p><figcaption>Malware executable masquerading as folder. With the normal Windows settings, the original folder &ldquo;backup&rdquo; is not shown because it is set to &ldquo;hidden&rdquo;. The malware executable &ldquo;backup.exe&rdquo; looks like a real folder because it has a folder icon and its &ldquo;exe&rdquo; extension is not shown.</figcaption></p>

<p>Sure enough, being careless, I fell for the trick.  The trojan installed a &ldquo;scareware&rdquo; Malware and Spyware scanner; whoever the authors are, they are not without a perverse sense of humor.  The fake scanner &ldquo;detected&rdquo; random programs on the hard drive as malware.  If you fall for the legitimate-sounding messages, you undoubted would be sending them your credit card information at some point.  Now only an idiot would do that (apologies to those who actually did).  This trojan is not a one-trick pony.  It has a fairly standard bag of tricks:</p>

<ul>
<li>It  modifies Windows&#8217; Registry so that it would be loaded automatically when the computer boots</li>
<li>It modifies the Windows Hosts file to redirect google.com, yahoo.com and bing.com to ad sites</li>
<li>It changes your IE homepage to point to its own site</li>
<li>If you start Task Manager or any other program, it immediately kills it so that you have no control whatsoever of the computer with the only recourse to click on the link that the fake scanner provides</li>
</ul>


<p>At this point, it looked like I was stuck.  I finally managed to kill the fake scanner&rsquo;s process (defender.exe) from Task Manager with some quick fingers.  It helps to be familiar with keyboard shortcuts.  Once I regained control of the computer, I used <a href="http://free.antivirus.com/hijackthis">HijackThis</a> to remove the infection from the Hosts file, IE and Registry. I manually deleted the executables referenced in the registry.  Then I put the computer through a rigorous scan with <a href="http://www.malwarebytes.org/">MalwareBytes</a>.</p>

<p>To cleanse the USB drive, simply select Tools  > Folder Options > View in Windows Explorer. Select <code>Show hidden files and folders</code> and uncheck <code>Hide extensions for known file types</code>.  This allows you to see the hidden original folders.  You can simply delete the fake files and folders.  To be able to see the files and folders normally,  you&rsquo;ll have to turn off the hidden and system attributes.  You can do so with the command <code>attrib -h -s "file name"</code>.</p>

<p>Now I&rsquo;ll have to go change all of my passwords.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Yen Tran</span></span>

      








  


<time datetime="2011-08-23T00:00:00-04:00" pubdate data-updated="true">Aug 23<span>rd</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/technology/'>technology</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://dinhyen.github.io/blog/2011/08/23/removing-malware/" data-via="" data-counturl="http://dinhyen.github.io/blog/2011/08/23/removing-malware/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2011/08/14/installing-windows-7-x86-for-the-asrock-939dual-sata2-motherboard/" title="Previous Post: Installing Windows 7 for the ASRock 939Dual-SATA2 motherboard">&laquo; Installing Windows 7 for the ASRock 939Dual-SATA2 motherboard</a>
      
      
        <a class="basic-alignment right" href="/blog/2011/09/06/book-review-wizards-first-rule-sword-of-truth-series-book-1-by-terry-goodkind/" title="Next Post: Wizard's First Rule (Sword of Truth series, Book 1) by Terry Goodkind">Wizard's First Rule (Sword of Truth series, Book 1) by Terry Goodkind &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/11/02/fixing-windows-media-center-no-tuner-available-error-with-hdhomerun-prime/">Fixing Windows Media Center No Tuner Available Error With HDHomeRun Prime</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/31/helper-method-generate-nested-tags-from-block/">Helper Method to Generate Nested Tags From Block</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/23/bruins-took-down-sabres-in-costly-victory/">Bruins Took Down Sabres in Costly Victory</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/28/simple-table-sorting-with-angular/">Simple Table Sorting With Angular</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/27/wix-executing-custom-action-before-starting-windows-service/">Wix: Executing Custom Action Before Starting Windows Service</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Yen Tran -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
